<ui:composition 
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:q="http://huliqing.name/qfaces"
    xmlns:g="http://huliqing.name/qblog"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    template="/page.xhtml">

    <ui:define name="title">
        文章列表
    </ui:define>

    <ui:define name="GROUP_CONTENT">
        <q:saveState value="#{articlesWe.pageId}" />
        <q:saveState value="#{articlesWe.tag}" />
        <q:saveState value="#{articlesWe.year}" />
        <q:saveState value="#{articlesWe.month}" />
        <q:saveState value="#{articlesWe.day}" />

        <h:form>
        <q:scroller for="articles" listener="#{articlesWe.loadData}" 
                    var="article" pageSize="10">
            <h:dataTable id="articles" width="100%" border="0">
                <h:column>
                    <h:panelGroup layout="block" styleClass="css_article_title">
                        <h:outputLink value="/article/pageId=#{articlesWe.pageId},articleId=#{article.articleId}">
                            <h:outputText value="#{article.title}" />
                        </h:outputLink>
                    </h:panelGroup>
                    <h:panelGroup layout="block" styleClass="css_article_summary">
                        <h:outputText value="#{article.summary}..." rendered="#{article.summary != null}" />
                        <h:outputLink value="/article/articleId=#{article.articleId}">
                            <h:outputText value="[阅读全文]" />
                        </h:outputLink>
                    </h:panelGroup>
                    <h:panelGroup layout="block" styleClass="css_article_footer">
                        <h:outputText value="#{article.createDate}" >
                            <f:convertDateTime pattern="#{app.dateTimeFormat}" timeZone="#{app.timeZone}" />
                        </h:outputText>
                        <h:outputText value=" 阅读：#{article.totalView}" />
                        <h:outputText value=" 评论：#{article.totalReply}" />
                        <h:panelGroup layout="block" rendered="#{visitor.login}">
                            <span style="cursor:pointer;" 
                                  onclick="window.location.href='/admin/blog/articleEdit.faces?articleId=#{article.articleId}&amp;returnURL=#{app.currentURL}'"> 编辑 </span>
                            <span style="cursor:pointer;" 
                                  onclick="window.location.href='/admin/blog/articleDelete.faces?articleId=#{article.articleId}&amp;returnURL=#{app.currentURL}'"> 删除 </span>
                        </h:panelGroup>
                    </h:panelGroup>
                </h:column>
            </h:dataTable>
        </q:scroller>
        </h:form>
    </ui:define>
</ui:composition>